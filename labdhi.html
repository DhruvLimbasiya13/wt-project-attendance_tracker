<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Attendance Tracker</title>
  <style>
    table {
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid black;
      padding: 10px;
      text-align: center;
    }
    .status {
      font-weight: bold;
    }
    button {
      padding: 5px 10px;
      margin: 5px;
    }
    #absent-list, #totals {
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>Student Attendance Tracker</h1>
  <div id="table-container"></div>
  <div id="buttons"></div>
  <div id="absent-list"></div>
  <div id="totals">
    <p><b>Total Present:</b> <span id="present-count">0</span></p>
    <p><b>Total Absent:</b> <span id="absent-count">0</span></p>
  </div>

  <script>
    let n, m, currentMaxRoll;
    const container = document.getElementById("table-container");
    const buttonsDiv = document.getElementById("buttons");
    const absentDiv = document.getElementById("absent-list");

    function initializeTracker() {
      n = parseInt(prompt("Enter the starting roll call:"));
      m = parseInt(prompt("Enter the ending roll call:"));
      currentMaxRoll = m;

      if (isNaN(n) || isNaN(m) || m < n) {
        container.innerHTML = "<p>Please enter a valid roll range.</p>";
        buttonsDiv.innerHTML = "";
        absentDiv.innerHTML = "";
        return;
      }

      renderTable(n, m);
      renderButtons();
      updateAbsentList();
    }

    function renderTable(start, end) {
      let tableHTML = "<table id='attendanceTable'>";
      tableHTML += `
        <tr>
          <th>Roll No</th>
          <th>Present</th>
          <th>Absent</th>
          <th>Status</th>
          <th>Delete</th>
        </tr>
      `;

      for (let i = start; i <= end; i++) {
        tableHTML += generateRow(i);
      }

      tableHTML += "</table>";
      container.innerHTML = tableHTML;
    }

    function generateRow(roll) {
      return `
        <tr id="row-${roll}">
          <td>${roll}</td>
          <td><button onclick="markPresent(${roll})">✔</button></td>
          <td><button onclick="markAbsent(${roll})">✖</button></td>
          <td id="status-${roll}" class="status" style="color:red;">Absent</td>
          <td><button onclick="deleteRow(${roll})">Delete</button></td>
        </tr>
      `;
    }

    function renderButtons() {
      buttonsDiv.innerHTML = `
        <button onclick="resetTable()">Reset</button>
        <button onclick="addStudent()">Add Student</button>
      `;
    }

    function markPresent(roll) {
      const statusCell = document.getElementById(`status-${roll}`);
      if (statusCell && statusCell.textContent !== "Present") {
        statusCell.textContent = "Present";
        statusCell.style.color = "green";
        updateAbsentList();
      }
    }

    function markAbsent(roll) {
      const statusCell = document.getElementById(`status-${roll}`);
      if (statusCell && statusCell.textContent !== "Absent") {
        statusCell.textContent = "Absent";
        statusCell.style.color = "red";
        updateAbsentList();
      }
    }

    function deleteRow(roll) {
      const row = document.getElementById(`row-${roll}`);
      if (row) row.outerHTML = "";
      updateAbsentList();
    }

    function resetTable() {
      location.reload(); // Reloads the entire page
    }

    function addStudent() {
      currentMaxRoll++;
      const table = document.getElementById("attendanceTable");
      if (!table) {
        initializeTracker(); // In case table was deleted
      } else {
        table.innerHTML += generateRow(currentMaxRoll);
        updateAbsentList();
      }
    }

    function updateAbsentList() {
      let absentRolls = [];
      let totalPresent = 0;
      let totalAbsent = 0;

      const table = document.getElementById("attendanceTable");
      if (!table) return;

      const rows = table.getElementsByTagName("tr");
      for (let i = 1; i < rows.length; i++) { // Skip header
        const cells = rows[i].getElementsByTagName("td");
        const roll = cells[0].textContent;
        const status = cells[3].textContent;

        if (status === "Absent") {
          absentRolls.push(roll);
          totalAbsent++;
        } else if (status === "Present") {
          totalPresent++;
        }
      }

      // Display absent roll numbers
      if (absentRolls.length > 0) {
        absentDiv.innerHTML = `<b>Absent Roll Numbers:</b> ${absentRolls.join(", ")}`;
      } else {
        absentDiv.innerHTML = `<b>No students are currently marked absent.</b>`;
      }

      // Update present and absent counts
      document.getElementById("present-count").textContent = totalPresent;
      document.getElementById("absent-count").textContent = totalAbsent;
    }

    initializeTracker(); // Start the tracker on page load
  </script>

</body>
</html>
